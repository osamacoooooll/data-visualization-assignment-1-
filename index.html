<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Movie Data Visualization Dashboard</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,500,700" />
  <!-- Chart.js Library -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    /* Global Styles */
    body {
      font-family: 'Roboto', sans-serif;
      background-color: #f4f7f9;
      margin: 0;
      padding: 0;
    }
    header {
      background-color: #4CAF50;
      color: #fff;
      padding: 1rem;
      text-align: center;
    }
    .container {
      max-width: 1200px;
      margin: 2rem auto;
      padding: 0 1rem;
    }
    .controls {
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
      margin-bottom: 1rem;
    }
    .controls > div {
      margin: 0.5rem 0;
    }
    input[type="text"],
    select {
      padding: 0.5rem;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 1rem;
    }
    input[type="text"] {
      width: 250px;
    }
    select {
      width: 200px;
    }
    /* Table Styles */
    table {
      width: 100%;
      border-collapse: collapse;
      background-color: #fff;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    th, td {
      padding: 1rem;
      border-bottom: 1px solid #eee;
      text-align: left;
    }
    th {
      background-color: #f8f8f8;
      cursor: pointer;
      user-select: none;
    }
    tr:hover {
      background-color: #f1f1f1;
    }
    /* Responsive Table Styles */
    @media (max-width: 768px) {
      table, thead, tbody, th, td, tr {
        display: block;
      }
      th {
        position: absolute;
        top: -9999px;
        left: -9999px;
      }
      tr {
        margin-bottom: 1rem;
        border: 1px solid #ccc;
        border-radius: 4px;
        overflow: hidden;
      }
      td {
        padding: 0.5rem;
        border: none;
        border-bottom: 1px solid #eee;
        position: relative;
        padding-left: 50%;
      }
      td:before {
        position: absolute;
        left: 1rem;
        width: 45%;
        white-space: nowrap;
        font-weight: bold;
      }
      td:nth-of-type(1):before { content: "Title"; }
      td:nth-of-type(2):before { content: "Year"; }
      td:nth-of-type(3):before { content: "Director"; }
      td:nth-of-type(4):before { content: "Box Office"; }
      td:nth-of-type(5):before { content: "Country"; }
    }
    /* Charts container styling */
    .charts {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-around;
      margin-top: 2rem;
    }
    .charts canvas {
      max-width: 500px;
      margin: 1rem;
      background-color: #fff;
      padding: 1rem;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
  </style>
</head>
<body>
  <header>
    <h1>Movie Data Visualization Dashboard</h1>
  </header>
  <div class="container">
    <!-- Controls: Search and Sort -->
    <div class="controls">
      <div>
        <input type="text" id="searchInput" placeholder="Search by title..." />
      </div>
      <div>
        <select id="sortSelect">
          <option value="default">Sort By</option>
          <option value="title-asc">Title Ascending</option>
          <option value="title-desc">Title Descending</option>
          <option value="year-asc">Year Ascending</option>
          <option value="year-desc">Year Descending</option>
          <option value="box-asc">Box Office Ascending</option>
          <option value="box-desc">Box Office Descending</option>
        </select>
      </div>
    </div>
    <!-- Data Table -->
    <table id="movieTable">
      <thead>
        <tr>
          <th data-sort="title">Title</th>
          <th data-sort="release_year">Year</th>
          <th data-sort="director">Director</th>
          <th data-sort="box_office">Box Office</th>
          <th data-sort="country">Country</th>
        </tr>
      </thead>
      <tbody>
        <!-- Table rows populated by JavaScript -->
      </tbody>
    </table>
    
    <!-- Charts Section -->
    <div class="charts">
      <canvas id="barChart"></canvas>
      <canvas id="pieChart"></canvas>
      <canvas id="scatterChart"></canvas>
    </div>
  </div>
  
  <script>
    // Movie data array
    const movies = [
      {"title": "Avatar", "release_year": 2009, "director": "James Cameron", "box_office": "$2,923,706,026", "country": null},
      {"title": "Avengers: Endgame", "release_year": 2019, "director": "Anthony Russo, Joe Russo", "box_office": "$2,797,501,328", "country": "United States"},
      {"title": "Avatar: The Way of Water", "release_year": 2022, "director": "James Cameron", "box_office": "$2,320,250,281", "country": "United States"},
      {"title": "Titanic", "release_year": 1997, "director": "James Cameron", "box_office": "T$2,257,844,554", "country": "United States"},
      {"title": "Star Wars: The Force Awakens", "release_year": 2015, "director": "J. J. Abrams", "box_office": "$2,068,223,624", "country": "United States"},
      {"title": "Avengers: Infinity War", "release_year": 2018, "director": "Anthony Russo, Joe Russo", "box_office": "$2,048,359,754", "country": "United States"},
      {"title": "Ne Zha 2†", "release_year": 2025, "director": "Jiaozi", "box_office": "$1,985,082,560", "country": "China"},
      {"title": "Spider-Man: No Way Home", "release_year": 2021, "director": "Jon Watts", "box_office": "SM$1,922,598,800", "country": "United States"},
      {"title": "Inside Out 2", "release_year": 2024, "director": "Kelsey Mann", "box_office": "$1,698,863,816", "country": "United States"},
      {"title": "Jurassic World", "release_year": 2015, "director": "Colin Trevorrow", "box_office": "$1,671,537,444", "country": "United States"},
      {"title": "The Lion King", "release_year": 2019, "director": "Jon Favreau", "box_office": "$1,656,943,394", "country": "United States"},
      {"title": "The Avengers", "release_year": 2012, "director": "Joss Whedon", "box_office": "$1,518,815,515", "country": "United States"},
      {"title": "Furious 7", "release_year": 2015, "director": "James Wan", "box_office": "$1,515,341,399", "country": null},
      {"title": "Top Gun: Maverick", "release_year": 2022, "director": "Joseph Kosinski", "box_office": "$1,495,696,292", "country": "United States"},
      {"title": "Frozen 2", "release_year": 2019, "director": "Chris Buck, Jennifer Lee", "box_office": "$1,450,026,933", "country": "United States"},
      {"title": "Barbie", "release_year": 2023, "director": "Greta Gerwig", "box_office": "$1,447,038,421", "country": null},
      {"title": "Avengers: Age of Ultron", "release_year": 2015, "director": "Joss Whedon", "box_office": "$1,402,809,540", "country": "United States"},
      {"title": "The Super Mario Bros. Movie", "release_year": 2023, "director": "Aaron Horvath, Michael Jelenic", "box_office": "$1,362,566,989", "country": "United States"},
      {"title": "Black Panther", "release_year": 2018, "director": "Ryan Coogler", "box_office": "$1,347,280,838", "country": "United States"},
      {"title": "Harry Potter and the Deathly Hallows – Part 2", "release_year": 2011, "director": "David Yates", "box_office": "$1,342,139,727", "country": null},
      {"title": "Deadpool & Wolverine", "release_year": 2024, "director": "Shawn Levy", "box_office": "$1,338,073,645", "country": "United States"},
      {"title": "Star Wars: The Last Jedi", "release_year": 2017, "director": "Rian Johnson", "box_office": "$1,332,539,889", "country": "United States"},
      {"title": "Jurassic World: Fallen Kingdom", "release_year": 2018, "director": "J. A. Bayona", "box_office": "$1,308,473,425", "country": null},
      {"title": "Frozen", "release_year": 2013, "director": "Chris Buck, Jennifer Lee", "box_office": "F$1,290,000,000", "country": "United States"},
      {"title": "Beauty and the Beast", "release_year": 2017, "director": "Bill Condon", "box_office": "$1,263,521,126", "country": "United States"},
      {"title": "Incredibles 2", "release_year": 2018, "director": "Brad Bird", "box_office": "$1,242,805,359", "country": "United States"},
      {"title": "The Fate of the Furious", "release_year": 2017, "director": "F. Gary Gray", "box_office": "F8$1,238,764,765", "country": null},
      {"title": "Iron Man 3", "release_year": 2013, "director": "Shane Black", "box_office": "$1,214,811,252", "country": "United States"},
      {"title": "Minions", "release_year": 2015, "director": "Pierre Coffin, Kyle Balda", "box_office": "$1,159,444,662", "country": "United States"},
      {"title": "Captain America: Civil War", "release_year": 2016, "director": "Anthony Russo, Joe Russo", "box_office": "$1,153,337,496", "country": "United States"},
      {"title": "Aquaman", "release_year": 2018, "director": "James Wan", "box_office": "$1,148,528,393", "country": "United States"},
      {"title": "The Lord of the Rings: The Return of the King", "release_year": 2003, "director": "Peter Jackson", "box_office": "$1,147,997,407", "country": null},
      {"title": "Spider-Man: Far From Home", "release_year": 2019, "director": "Jon Watts", "box_office": "$1,132,679,685", "country": "United States"},
      {"title": "Captain Marvel", "release_year": 2019, "director": "Anna Boden, Ryan Fleck", "box_office": "$1,128,274,794", "country": "United States"},
      {"title": "Transformers: Dark of the Moon", "release_year": 2011, "director": "Michael Bay", "box_office": "$1,123,794,079", "country": "United States"},
      {"title": "Skyfall", "release_year": 2012, "director": "Sam Mendes", "box_office": "$1,108,594,137", "country": null},
      {"title": "Transformers: Age of Extinction", "release_year": 2014, "director": "Michael Bay", "box_office": "$1,104,054,072", "country": "United States"},
      {"title": "The Dark Knight Rises", "release_year": 2012, "director": "Christopher Nolan", "box_office": "DKR$1,081,169,825", "country": null},
      {"title": "Joker", "release_year": 2019, "director": "Todd Phillips", "box_office": "$1,074,458,282", "country": "United States"},
      {"title": "Star Wars: The Rise of Skywalker", "release_year": 2019, "director": "J. J. Abrams", "box_office": "$1,074,144,248", "country": "United States"},
      {"title": "Toy Story 4", "release_year": 2019, "director": "Josh Cooley", "box_office": "$1,073,394,593", "country": "United States"},
      {"title": "Toy Story 3", "release_year": 2010, "director": "Lee Unkrich", "box_office": "$1,066,970,811", "country": "United States"},
      {"title": "Pirates of the Caribbean: Dead Man's Chest", "release_year": 2006, "director": "Gore Verbinski", "box_office": "$1,066,179,747", "country": "United States"},
      {"title": "Rogue One: A Star Wars Story", "release_year": 2016, "director": "Gareth Edwards", "box_office": "$1,057,420,387", "country": "United States"},
      {"title": "Moana 2†", "release_year": 2024, "director": "David Derrick Jr., [, 1, ], Jason Hand, [, 1, ], Dana Ledoux Miller, [, 1, ]", "box_office": "$1,053,978,188", "country": "United States"},
      {"title": "Aladdin", "release_year": 2019, "director": "Guy Ritchie", "box_office": "$1,050,693,953", "country": "United States"},
      {"title": "Star Wars: Episode I – The Phantom Menace", "release_year": 1999, "director": "George Lucas", "box_office": "$1,046,515,409", "country": "United States"},
      {"title": "Pirates of the Caribbean: On Stranger Tides", "release_year": 2011, "director": "Rob Marshall", "box_office": "$1,045,713,802", "country": "United States"},
      {"title": "Jurassic Park", "release_year": 1993, "director": "Steven Spielberg", "box_office": "$1,037,535,230", "country": "United States"},
      {"title": "Despicable Me 3", "release_year": 2017, "director": "Pierre Coffin, Kyle Balda", "box_office": "$1,034,800,131", "country": "United States"}
    ];
    
    // Copy of movies used for filtering and sorting.
    let filteredMovies = [...movies];
    
    const movieTableBody = document.querySelector('#movieTable tbody');
    const searchInput = document.getElementById('searchInput');
    const sortSelect = document.getElementById('sortSelect');
    
    // Helper function: extract numeric value from the box office string.
    function parseBoxOffice(boxOffice) {
      const numericValue = boxOffice.replace(/[^0-9]/g, '');
      return parseInt(numericValue);
    }
    
    // Render the table rows.
    function renderTable(data) {
      movieTableBody.innerHTML = '';
      data.forEach(movie => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${movie.title}</td>
          <td>${movie.release_year}</td>
          <td>${movie.director}</td>
          <td>${movie.box_office}</td>
          <td>${movie.country ? movie.country : 'N/A'}</td>
        `;
        movieTableBody.appendChild(row);
      });
      updateCharts();
    }
    
    // Filter movies by title based on the search input.
    function filterMovies() {
      const query = searchInput.value.toLowerCase();
      filteredMovies = movies.filter(movie => movie.title.toLowerCase().includes(query));
      sortMovies();
    }
    
    // Sort the filtered movies based on the selected option.
    function sortMovies() {
      const sortValue = sortSelect.value;
      if (sortValue === 'title-asc') {
        filteredMovies.sort((a, b) => a.title.localeCompare(b.title));
      } else if (sortValue === 'title-desc') {
        filteredMovies.sort((a, b) => b.title.localeCompare(a.title));
      } else if (sortValue === 'year-asc') {
        filteredMovies.sort((a, b) => a.release_year - b.release_year);
      } else if (sortValue === 'year-desc') {
        filteredMovies.sort((a, b) => b.release_year - a.release_year);
      } else if (sortValue === 'box-asc') {
        filteredMovies.sort((a, b) => parseBoxOffice(a.box_office) - parseBoxOffice(b.box_office));
      } else if (sortValue === 'box-desc') {
        filteredMovies.sort((a, b) => parseBoxOffice(b.box_office) - parseBoxOffice(a.box_office));
      }
      renderTable(filteredMovies);
    }
    
    // Event listeners for filtering and sorting.
    searchInput.addEventListener('input', filterMovies);
    sortSelect.addEventListener('change', sortMovies);
    
    // Optional: Allow sorting by clicking on table headers.
    document.querySelectorAll('th').forEach(header => {
      header.addEventListener('click', () => {
        const sortKey = header.getAttribute('data-sort');
        let newOrder = sortKey + '-asc';
        if (sortSelect.value === sortKey + '-asc') {
          newOrder = sortKey + '-desc';
        }
        sortSelect.value = newOrder;
        sortMovies();
      });
    });
    
    // --------------------- Chart.js Visualizations ---------------------
    function updateCharts() {
      // Use filteredMovies so that the charts update along with the table.
      const moviesForCharts = filteredMovies;
      
      // 1. Bar Chart: Top 10 movies by box office.
      const moviesSortedByRevenue = [...moviesForCharts].sort((a, b) => parseBoxOffice(b.box_office) - parseBoxOffice(a.box_office));
      const top10 = moviesSortedByRevenue.slice(0, 10);
      const barLabels = top10.map(movie => movie.title);
      const barData = top10.map(movie => parseBoxOffice(movie.box_office));
      
      if (window.barChart) {
        window.barChart.data.labels = barLabels;
        window.barChart.data.datasets[0].data = barData;
        window.barChart.update();
      } else {
        const barCtx = document.getElementById('barChart').getContext('2d');
        window.barChart = new Chart(barCtx, {
          type: 'bar',
          data: {
            labels: barLabels,
            datasets: [{
              label: 'Box Office (USD)',
              data: barData,
              backgroundColor: 'rgba(76, 175, 80, 0.6)',
              borderColor: 'rgba(76, 175, 80, 1)',
              borderWidth: 1
            }]
          },
          options: {
            responsive: true,
            plugins: {
              title: {
                display: true,
                text: 'Top 10 Box Office Movies'
              },
              tooltip: {
                callbacks: {
                  label: context => '$' + context.parsed.y.toLocaleString()
                }
              }
            },
            scales: {
              y: {
                beginAtZero: true,
                ticks: {
                  callback: value => '$' + value.toLocaleString()
                }
              }
            }
          }
        });
      }
      
      // 2. Pie Chart: Distribution of movies by country.
      const countryCounts = {};
      moviesForCharts.forEach(movie => {
        const country = movie.country ? movie.country : "Unknown";
        countryCounts[country] = (countryCounts[country] || 0) + 1;
      });
      const pieLabels = Object.keys(countryCounts);
      const pieData = Object.values(countryCounts);
      
      if (window.pieChart) {
        window.pieChart.data.labels = pieLabels;
        window.pieChart.data.datasets[0].data = pieData;
        window.pieChart.update();
      } else {
        const pieCtx = document.getElementById('pieChart').getContext('2d');
        window.pieChart = new Chart(pieCtx, {
          type: 'pie',
          data: {
            labels: pieLabels,
            datasets: [{
              label: 'Movies by Country',
              data: pieData,
              backgroundColor: [
                'rgba(255, 99, 132, 0.6)',
                'rgba(54, 162, 235, 0.6)',
                'rgba(255, 206, 86, 0.6)',
                'rgba(75, 192, 192, 0.6)',
                'rgba(153, 102, 255, 0.6)',
                'rgba(255, 159, 64, 0.6)'
              ],
              borderWidth: 1
            }]
          },
          options: {
            responsive: true,
            plugins: {
              title: {
                display: true,
                text: 'Movies by Country'
              }
            }
          }
        });
      }
      
      // 3. Scatter Chart: Release Year vs Box Office.
      const scatterData = moviesForCharts.map(movie => ({
        x: movie.release_year,
        y: parseBoxOffice(movie.box_office),
        title: movie.title
      }));
      
      if (window.scatterChart) {
        window.scatterChart.data.datasets[0].data = scatterData;
        window.scatterChart.update();
      } else {
        const scatterCtx = document.getElementById('scatterChart').getContext('2d');
        window.scatterChart = new Chart(scatterCtx, {
          type: 'scatter',
          data: {
            datasets: [{
              label: 'Movies',
              data: scatterData,
              backgroundColor: 'rgba(255, 99, 132, 0.6)'
            }]
          },
          options: {
            responsive: true,
            plugins: {
              title: {
                display: true,
                text: 'Release Year vs Box Office'
              },
              tooltip: {
                callbacks: {
                  label: context => {
                    const point = context.raw;
                    return point.title + ': $' + point.y.toLocaleString();
                  }
                }
              }
            },
            scales: {
              x: {
                title: {
                  display: true,
                  text: 'Release Year'
                },
                ticks: {
                  precision: 0
                }
              },
              y: {
                title: {
                  display: true,
                  text: 'Box Office (USD)'
                },
                ticks: {
                  callback: value => '$' + value.toLocaleString()
                }
              }
            }
          }
        });
      }
    }
    
    // Initial render
    renderTable(filteredMovies);
  </script>
</body>
</html>
